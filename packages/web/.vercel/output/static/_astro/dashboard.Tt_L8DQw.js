import{i as K,o as st,g as d,j as b,k as s,c as S,t as $,S as P,m as nt,l as F,s as o,n as N,F as A}from"./web.CxjjJZrc.js";import{m as ot}from"./index.DmeqUQK-.js";import{$ as ct}from"./auth.YqlKLZ3z.js";import"./store.CsayWp_b.js";async function J(k){try{const m=await fetch(k,{method:"GET",credentials:"include"}),U=await m.json();return m.ok?{success:!0,data:U}:{success:!1,error:U.error||{code:"UNKNOWN",message:"An error occurred"}}}catch{return{success:!1,error:{code:"NETWORK",message:"Network error"}}}}async function dt(){return J("/api/dashboard/stats")}async function gt(){return J("/api/dashboard/metrics")}var ht=$('<div class="animate-pulse space-y-6"><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">'),vt=$('<div class="card p-6 bg-red-50 border-red-200"><p class=text-red-600>'),xt=$('<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"><div class=stat-card><div class=stat-value style=color:var(--color-primary)></div><div class=stat-label>Total Wallets Generated</div></div><div class=stat-card><div class=stat-value><!$><!/><span class="text-lg font-normal text-[var(--color-gray-500)]">/hr</span></div><div class=stat-label>Generation Rate</div></div><div class=stat-card><div class=stat-value><!$><!/><span class="text-lg font-normal text-[var(--color-gray-500)]">/<!$><!/></span></div><div class=stat-label>Machines Online</div></div><div class=stat-card><div class=stat-value><!$><!/><span class="text-lg font-normal text-[var(--color-gray-500)]">%</span></div><div class=stat-label>Average CPU Usage'),ut=$('<div class="card p-6"><h3 class="text-lg font-semibold text-[var(--color-gray-900)] mb-4">Machine Status</h3><div class="grid grid-cols-2 md:grid-cols-4 gap-4"><div class="text-center p-4 rounded-lg bg-[var(--color-gray-50)]"><div class="text-2xl font-semibold text-[var(--color-gray-900)]"></div><div class="text-sm text-[var(--color-gray-500)]">Total Machines</div></div><div class="text-center p-4 rounded-lg bg-[var(--color-gray-50)]"><div class="text-2xl font-semibold"style=color:var(--color-primary)></div><div class=text-sm style=color:var(--color-primary)>Online</div></div><div class="text-center p-4 rounded-lg bg-[var(--color-gray-50)]"><div class="text-2xl font-semibold text-[var(--color-gray-600)]"></div><div class="text-sm text-[var(--color-gray-500)]">Offline</div></div><div class="text-center p-4 rounded-lg bg-[var(--color-gray-50)]"><div class="text-2xl font-semibold text-[var(--color-gray-900)]"></div><div class="text-sm text-[var(--color-gray-500)]">Reporting'),q=$("<div class=h-64>"),$t=$('<div class="grid grid-cols-1 lg:grid-cols-2 gap-6"><div class="card p-6"><h3 class="text-lg font-semibold text-[var(--color-gray-900)] mb-4">Generation Rate (Last Hour)</h3><!$><!/></div><div class="card p-6"><h3 class="text-lg font-semibold text-[var(--color-gray-900)] mb-4">CPU Usage (Last Hour)</h3><!$><!/>'),ft=$("<div class=h-48>"),_t=$('<div class="card p-6"><h3 class="text-lg font-semibold text-[var(--color-gray-900)] mb-4">Last 24 Hours</h3><!$><!/>'),mt=$("<div class=space-y-6><!$><!/><!$><!/><!$><!/>"),bt=$('<div class=stat-card><div class="h-8 bg-[var(--color-gray-200)] rounded w-1/2 mb-2"></div><div class="h-4 bg-[var(--color-gray-100)] rounded w-2/3">'),z=$('<div class="h-64 flex items-center justify-center text-[var(--color-gray-500)]">No data available'),yt=$('<div class="h-48 flex items-center justify-center text-[var(--color-gray-500)]">No historical data available'),pt=$('<svg viewBox="0 0 500 250"class="w-full h-full"><!$><!/><!$><!/><text x=250 y=245 text-anchor=middle class="text-xs fill-[var(--color-gray-500)]">Time (Last Hour)</text><text transform="translate(15, 125) rotate(-90)"text-anchor=middle class="text-xs fill-[var(--color-gray-500)]">Keys/min'),B=$("<svg><line stroke=var(--color-gray-200)></svg>",!1,!0,!1),Q=$('<svg><text text-anchor=end class="text-xs fill-[var(--color-gray-400)]"></svg>',!1,!0,!1),St=$("<svg><rect fill=var(--color-primary) rx=2></svg>",!1,!0,!1),wt=$('<svg viewBox="0 0 500 250"class="w-full h-full"><!$><!/><path fill=var(--color-primary) fill-opacity=0.1></path><path fill=none stroke=var(--color-primary) stroke-width=2 stroke-linecap=round stroke-linejoin=round></path><text x=250 y=245 text-anchor=middle class="text-xs fill-[var(--color-gray-500)]">Time (Last Hour)</text><text transform="translate(15, 125) rotate(-90)"text-anchor=middle class="text-xs fill-[var(--color-gray-500)]">CPU Usage (%)'),Ct=$('<svg><text text-anchor=end class="text-xs fill-[var(--color-gray-400)]"><!$><!/>%</svg>',!1,!0,!1),kt=$('<svg viewBox="0 0 800 180"class="w-full h-full"><!$><!/><!$><!/>'),Mt=$('<svg><text y=160 text-anchor=middle class="text-xs fill-[var(--color-gray-400)]"><!$><!/>h</svg>',!1,!0,!1),Wt=$("<svg><g><rect fill=var(--color-gray-300) rx=2></rect><!$><!/></svg>",!1,!0,!1);function Pt(){const k=ot(ct),[m,U]=K(null),[t,M]=K(null),[_,W]=K(!0),[R,r]=K(""),y=async(i=!0)=>{if(i&&W(!0),!k().isAuthenticated){r("Not authenticated"),W(!1);return}const[u,v]=await Promise.all([dt(),gt()]);u.success&&u.data?U(u.data):r(u.error?.message||"Failed to load dashboard"),v.success&&v.data&&M(v.data),i&&W(!1)},x=i=>i>=1e6?`${(i/1e6).toFixed(1)}M`:i>=1e3?`${(i/1e3).toFixed(1)}K`:i.toString();return st(()=>{y(!0);const i=setInterval(()=>y(!1),1e4);return()=>clearInterval(i)}),(()=>{var i=d(mt),u=i.firstChild,[v,p]=b(u.nextSibling),c=v.nextSibling,[g,l]=b(c.nextSibling),a=g.nextSibling,[n,f]=b(a.nextSibling);return s(i,S(P,{get when(){return _()},get children(){var e=d(ht),h=e.firstChild;return s(h,()=>[1,2,3,4].map(()=>d(bt))),e}}),v,p),s(i,S(P,{get when(){return R()},get children(){var e=d(vt),h=e.firstChild;return s(h,R),e}}),g,l),s(i,S(P,{get when(){return nt(()=>!_())()&&m()},get children(){return[(()=>{var e=d(xt),h=e.firstChild,C=h.firstChild,w=h.nextSibling,H=w.firstChild,L=H.firstChild,[O,T]=b(L.nextSibling);O.nextSibling;var D=w.nextSibling,E=D.firstChild,G=E.firstChild,[j,X]=b(G.nextSibling),I=j.nextSibling,Y=I.firstChild,tt=Y.nextSibling,[et,rt]=b(tt.nextSibling),lt=D.nextSibling,V=lt.firstChild,at=V.firstChild,[Z,it]=b(at.nextSibling);return Z.nextSibling,s(C,()=>x(m().estimates.total_wallets)),s(H,()=>x(m().estimates.hourly_rate),O,T),s(E,()=>m().workers.online,j,X),s(I,()=>m().workers.total,et,rt),s(V,()=>m().metrics.avg_cpu,Z,it),e})(),(()=>{var e=d(ut),h=e.firstChild,C=h.nextSibling,w=C.firstChild,H=w.firstChild,L=w.nextSibling,O=L.firstChild,T=L.nextSibling,D=T.firstChild,E=T.nextSibling,G=E.firstChild;return s(H,()=>m().workers.total),s(O,()=>m().workers.online),s(D,()=>m().workers.offline),s(G,()=>m().metrics.workers_reporting),e})(),(()=>{var e=d($t),h=e.firstChild,C=h.firstChild,w=C.nextSibling,[H,L]=b(w.nextSibling),O=h.nextSibling,T=O.firstChild,D=T.nextSibling,[E,G]=b(D.nextSibling);return s(h,S(P,{get when(){return t()?.metrics.length},get fallback(){return d(z)},get children(){var j=d(q);return s(j,S(Ht,{get metrics(){return t().metrics}})),j}}),H,L),s(O,S(P,{get when(){return t()?.metrics.length},get fallback(){return d(z)},get children(){var j=d(q);return s(j,S(Nt,{get metrics(){return t().metrics}})),j}}),E,G),e})(),(()=>{var e=d(_t),h=e.firstChild,C=h.nextSibling,[w,H]=b(C.nextSibling);return s(e,S(P,{get when(){return m().history.length>0},get fallback(){return d(yt)},get children(){var L=d(ft);return s(L,S(Rt,{get history(){return m().history}})),L}}),w,H),e})()]}}),n,f),i})()}function Ht(k){const t={top:20,right:20,bottom:40,left:60},M=500-t.left-t.right,_=250-t.top-t.bottom,W=F(()=>Math.max(...k.metrics.map(r=>r.total_rate),1)),R=F(()=>{const r=k.metrics,y=Math.max(2,M/r.length-2);return r.map((x,i)=>{const u=t.left+i*(M/r.length),v=x.total_rate/W()*_,p=t.top+_-v;return{x:u,y:p,width:y,height:v,value:x.total_rate}})});return(()=>{var r=d(pt),y=r.firstChild,[x,i]=b(y.nextSibling),u=x.nextSibling,[v,p]=b(u.nextSibling),c=v.nextSibling;return c.nextSibling,s(r,S(A,{each:[0,.25,.5,.75,1],children:g=>{const l=t.top+_*(1-g),a=Math.round(W()*g);return[(()=>{var n=d(B);return o(n,"y1",l),o(n,"y2",l),N(f=>{var e=t.left,h=500-t.right;return e!==f.e&&o(n,"x1",f.e=e),h!==f.t&&o(n,"x2",f.t=h),f},{e:void 0,t:void 0}),n})(),(()=>{var n=d(Q);return o(n,"y",l+4),s(n,a),N(()=>o(n,"x",t.left-10)),n})()]}}),x,i),s(r,S(A,{get each(){return R()},children:g=>(()=>{var l=d(St);return N(a=>{var n=g.x,f=g.y,e=g.width,h=g.height;return n!==a.e&&o(l,"x",a.e=n),f!==a.t&&o(l,"y",a.t=f),e!==a.a&&o(l,"width",a.a=e),h!==a.o&&o(l,"height",a.o=h),a},{e:void 0,t:void 0,a:void 0,o:void 0}),l})()}),v,p),r})()}function Nt(k){const t={top:20,right:20,bottom:40,left:60},M=500-t.left-t.right,_=250-t.top-t.bottom,W=F(()=>{const r=k.metrics;if(r.length<2)return"";const y=M/(r.length-1),x=_/100;return r.map((i,u)=>{const v=t.left+u*y,p=t.top+_-i.avg_cpu*x;return`${u===0?"M":"L"} ${v} ${p}`}).join(" ")}),R=F(()=>{const r=k.metrics;if(r.length<2)return"";const y=M/(r.length-1),x=_/100,i=r.map((u,v)=>{const p=t.left+v*y,c=t.top+_-u.avg_cpu*x;return`${p} ${c}`});return`M ${t.left} ${t.top+_} L ${i.join(" L ")} L ${t.left+M} ${t.top+_} Z`});return(()=>{var r=d(wt),y=r.firstChild,[x,i]=b(y.nextSibling),u=x.nextSibling,v=u.nextSibling,p=v.nextSibling;return p.nextSibling,s(r,S(A,{each:[0,25,50,75,100],children:c=>{const g=t.top+_-c/100*_;return[(()=>{var l=d(B);return o(l,"y1",g),o(l,"y2",g),N(a=>{var n=t.left,f=500-t.right;return n!==a.e&&o(l,"x1",a.e=n),f!==a.t&&o(l,"x2",a.t=f),a},{e:void 0,t:void 0}),l})(),(()=>{var l=d(Ct),a=l.firstChild,[n,f]=b(a.nextSibling);return n.nextSibling,o(l,"y",g+4),s(l,c,n,f),N(()=>o(l,"x",t.left-10)),l})()]}}),x,i),N(c=>{var g=R(),l=W();return g!==c.e&&o(u,"d",c.e=g),l!==c.t&&o(v,"d",c.t=l),c},{e:void 0,t:void 0}),r})()}function Rt(k){const t={top:20,right:60,bottom:40,left:60},M=800-t.left-t.right,_=180-t.top-t.bottom,W=F(()=>Math.max(...k.history.map(r=>r.total_rate),1)),R=F(()=>{const r=k.history,y=Math.max(8,M/r.length-4);return r.map((x,i)=>{const u=t.left+i*(M/r.length)+2,v=x.total_rate/W()*_,p=t.top+_-v,c=new Date(x.hour).getHours();return{x:u,y:p,width:y,height:v,value:x.total_rate,hour:c}})});return(()=>{var r=d(kt),y=r.firstChild,[x,i]=b(y.nextSibling),u=x.nextSibling,[v,p]=b(u.nextSibling);return s(r,S(A,{each:[0,.5,1],children:c=>{const g=t.top+_*(1-c),l=Math.round(W()*c);return[(()=>{var a=d(B);return o(a,"y1",g),o(a,"y2",g),N(n=>{var f=t.left,e=800-t.right;return f!==n.e&&o(a,"x1",n.e=f),e!==n.t&&o(a,"x2",n.t=e),n},{e:void 0,t:void 0}),a})(),(()=>{var a=d(Q);return o(a,"y",g+4),s(a,l),N(()=>o(a,"x",t.left-10)),a})()]}}),x,i),s(r,S(A,{get each(){return R()},children:c=>(()=>{var g=d(Wt),l=g.firstChild,a=l.nextSibling,[n,f]=b(a.nextSibling);return s(g,S(P,{get when(){return R().indexOf(c)%4===0},get children(){var e=d(Mt),h=e.firstChild,[C,w]=b(h.nextSibling);return C.nextSibling,s(e,()=>c.hour,C,w),N(()=>o(e,"x",c.x+c.width/2)),e}}),n,f),N(e=>{var h=c.x,C=c.y,w=c.width,H=c.height;return h!==e.e&&o(l,"x",e.e=h),C!==e.t&&o(l,"y",e.t=C),w!==e.a&&o(l,"width",e.a=w),H!==e.o&&o(l,"height",e.o=H),e},{e:void 0,t:void 0,a:void 0,o:void 0}),g})()}),v,p),r})()}export{Pt as DashboardView};
